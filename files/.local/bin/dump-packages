#!/usr/bin/env sh

set -x

DOTFILES_DIR="$HOME/.dotfiles"
BREWFILE_PATH="$DOTFILES_DIR/Brewfile"
FLATPAK_APPS_FILE_PATH="$DOTFILES_DIR/FlatpakApps"
FLATPAK_RUNTIMES_FILE_PATH="$DOTFILES_DIR/FlatpakRuntimes"

test -d "$HOME/.linuxbrew" && eval "$($HOME/.linuxbrew/bin/brew shellenv)"
test -d "/home/linuxbrew/.linuxbrew" && eval "$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)"

brew bundle dump --describe --no-restart --force --file "$BREWFILE_PATH"
sed -i '/^vscode /d' "$BREWFILE_PATH"

flatpak list --app --columns=application > "$FLATPAK_APPS_FILE_PATH"
